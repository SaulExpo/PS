<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Gr√°ficos</title>

    <link rel="stylesheet" href="/PWM-Fitness-App-master/Styles/header.css">
    <link rel="stylesheet" href="/PWM-Fitness-App-master/Styles/footer.css">
    <link rel="stylesheet" href="/PWM-Fitness-App-master/Styles/graphic.css">

    <script src="/PWM-Fitness-App-master/JavaScript/xlu-include-file.js"></script>
    <script src="https://www.gstatic.com/charts/loader.js"></script>
    <script>
        google.charts.load('current', {packages: ['corechart']});
        google.charts.setOnLoadCallback(() => loadData('calorias.js', 'month'));

        function loadData(filename, range = 'month') {
            fetch(filename)
                .then(response => response.json())
                .then(data => {
                    if (range === 'week') {
                        data = data.slice(-7);
                    }
                    drawChart(data, filename);
                })
                .catch(error => console.error('Error cargando datos:', error));
        }

        function drawChart(dataArray, filename) {
            var data = new google.visualization.DataTable();
            data.addColumn('string', 'Day');

            let title, vAxisTitle;

            if (filename === 'calorias.js') {
                data.addColumn('number', 'Calories Burn');
                title = 'Calories Burn per Day';
                vAxisTitle = 'Calories';
                dataArray.forEach(item => {
                    let caloriasQuemadas = calcularCalorias(item.met, item.peso, item.minutos);
                    data.addRow([item.dia, caloriasQuemadas]);
                });
            } else {
                data.addColumn('number', 'Steps');
                title = 'Steps Done per Day';
                vAxisTitle = 'Steps';
                dataArray.forEach(item => {
                    data.addRow([item.dia, item.valor]);
                });
            }

            var options = {
                title: title,
                hAxis: {title: 'Day of the Month'},
                vAxis: {title: vAxisTitle},
                legend: 'none',
                colors: ['#4285F4'],
                tooltip: {
                    isHtml: false,
                    textStyle: {
                        fontSize: 10,
                        bold: false,
                        color: '#333'
                    }
                }
            };

            document.getElementById('chart_div').innerHTML = '';

            var chart = new google.visualization.ColumnChart(document.getElementById('chart_div'));
            chart.draw(data, options);
        }

        function calcularCalorias(met, peso, minutos) {
            return ((met * peso * 3.5) / 200) * minutos;
        }
    </script>
</head>
<body>

<header xlu-include-file="/PWM-Fitness-App-master/Templates/header.html"></header>

<div class="buttons-container">
    <button onclick="loadData('calorias.js', 'month')">Show Calories</button>
    <button onclick="loadData('pasos.js', 'month')">Show Steps</button>
</div>

<div id="chart_div" class="chart-container"></div>

<div class="buttons-container">
    <button onclick="loadData('calorias.js', 'week')">Semana</button>
    <button onclick="loadData('calorias.js', 'month')">Mes</button>
</div>

<footer xlu-include-file="/PWM-Fitness-App-master/Templates/footer.html"></footer>

<script>xLuIncludeFile()</script>

</body>
</html>
